<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="stylesheet.css" />
    <title>quitz template</title>
    
</head>

<body>
    <div class="steps-container" id="steps-container">

    </div>
    <div class="question-container" id="question-container">
        <div class="question-title" id="question-title">
            Question
        </div>

        <div class="answers-container" id="answers-container">

        </div>

    </div>
    <br /><br />
    <div class="grid-container">
        <div class="grid-item">
            <div class="back-button" id="back-button">
                Back
            </div>
        </div>
        <div class="grid-item" id="next-button-column">
            <div class="next-button" id="next-button">
            </div>
        </div>

    </div>


    <script>MULTIPLE_CHOICE = 0;
        TEXT = 1;
        DRAG_N_DROP = 2;
        FILL_IN_BLANKS = 3;
        END = 4;

        var items = [
            {
                id: 0,
                question: 'Two Functional Programming Styles',
                type: TEXT,
                txt: '<p><strong>Higher order</strong></p><p>Example:</p><p><code>List.map F L</code></p><p>[ 59; 79; 82; 42; . . .] -&gt;&nbsp;[ F(59); F(79); F(82); F(42); . . .]</p>' +
                '<p><strong>Recursive</strong></p>' +
                '<p>process 1st element</p>'+
                '<p>[ 59; 79; 82; 42; . . .] -&gt; [ F(59); 79; 82; 42; . . .]&nbsp;</p>'+
                '<p>recursively process remaining elements</p>' +
                '<p>[ 59; 79; 82; 42; . . .] -&gt; [ F(59); F(79); 82; 42; . . .]&nbsp;</p>'
            },
            {
                id: 0,
                question: 'Standard Deviation Example',
                type: TEXT,
                txt: '<p>2, 4, 4, 4, 5, 7, 9</p>' +
                    '<p>These eight data points have the mean of 5:</p>' +
                    '<p>(2 + 4 + 4 + 4 + 5 + 7 + 9) / 8 = 5</p>' +
                    '<p>First, calculate the difference of each data point from the mean, and square the result of each:</p>' +
                    '<table width="258">' +
                    '<tbody>' +
                    '<tr>' +
                    '<td>(2-5)&sup2; = 9</td>' +
                    '<td>(5-5)&sup2; = 0</td>' +
                    '</tr>' +
                    '<tr>' +
                    '<td>(4-5)&sup2; = 1</td>' +
                    '<td>(5-5)&sup2; = 0</td>' +
                    '</tr>' +
                    '<tr>' +
                    '<td>(4-5)&sup2; = 1</td>' +
                    '<td>(7-5)&sup2; = 4</td>' +
                    '</tr>' +
                    '<tr>' +
                    '<td>(4-5)&sup2; = 1</td>' +
                    '<td>&nbsp;(9-5)&sup2; = 16</td>' +
                    '</tr>' +
                    '</tbody>' +
                    '</table>' +
                    '<p>Next, calculate the mean of these values, and take the square root:</p>' +
                    '<p>&radic;((9+1+1+1+0+0+4+16)/8) = 2</p>' 
            },
            {
                id: 0,
                question: 'Std Dev in F#',
                type: TEXT,
                txt: '<b>Read the following code carefully:</b><br>'+
                '<p><code><code></code></code></p>' +
                    '<div>#light</div>' +
                    '<p><code><code></code></code></p>' +
                    '<p>&nbsp;</p>' +
                    '<p><code><code></code></code></p>' +
                    '<div>[&lt;EntryPoint&gt;]</div>' +
                    '<p><code><code></code></code></p>' +
                    '<div><span style="color: #3366ff;">let</span> main argv <span style="color: #3366ff;">=</span></div>' +
                    '<p><code><code></code></code></p>' +
                    '<div>&nbsp; <span style="color: #3366ff;">let</span> data_array <span style="color: #3366ff;">=</span> System.IO.File.ReadAllLines<span style="color: #3366ff;">(</span>"<span style="color: #ff0000;">data.txt</span>"<span style="color: #3366ff;">)</span></div>' +
                    '<p><code><code></code></code></p>' +
                    '<div>&nbsp; <span style="color: #3366ff;">let</span> data_list <span style="color: #3366ff;">=</span> Array.toList data_array</div>' +
                    '<div>&nbsp;</div>' +
                    '<p><code><code></code></code></p>' +
                    '<div>&nbsp; <span style="color: #3366ff;">let</span> values <span style="color: #3366ff;">=</span> List.map (fun s -&gt; float s) data<span style="color: #3366ff;">_</span>list</div>' +
                    '<p><code><code></code></code></p>' +
                    '<div>&nbsp;</div>' +
                    '<div>&nbsp; <span style="color: #3366ff;">let</span> sum <span style="color: #3366ff;">=</span> List.reduce <span style="color: #3366ff;">(fun</span> x y <span style="color: #3366ff;">-&gt;</span> x <span style="color: #3366ff;">+</span> y<span style="color: #3366ff;">)</span> values</div>' +
                    '<p><code><code></code></code></p>' +
                    '<div>&nbsp; <span style="color: #3366ff;">let</span> mean <span style="color: #3366ff;">=</span> sum <span style="color: #3366ff;">/</span> float <span style="color: #3366ff;">(</span>List.length values<span style="color: #3366ff;">)</span></div>' +
                    '<p><code><code></code></code></p>' +
                    '<div>&nbsp;<span style="color: #3366ff;"> let</span> diffs = List.map <span style="color: #3366ff;">(fun</span> x <span style="color: #3366ff;">-&gt;(</span>x-mean<span style="color: #3366ff;">)</span>**<span style="color: #339966;">2.0</span><span style="color: #3366ff;">)</span> values</div>' +
                    '<p><code><code></code></code></p>' +
                    '<div>&nbsp;</div>' +
                    '<div>&nbsp; <span style="color: #3366ff;">let</span> sum2 <span style="color: #3366ff;">=</span> List.reduce <span style="color: #3366ff;">(fun</span> x y <span style="color: #3366ff;">-&gt;</span> x <span style="color: #3366ff;">+</span> y<span style="color: #3366ff;">)</span> diffs</div>' +
                    '<p><code><code></code></code></p>' +
                    '<div>&nbsp; <span style="color: #3366ff;">let</span> mean2 <span style="color: #3366ff;">=</span> sum2 <span style="color: #3366ff;">/</span> float <span style="color: #3366ff;">(</span>List.length diffs<span style="color: #3366ff;">)</span></div>' +
                    '<p><code><code></code></code></p>' +
                    '<div>&nbsp; <span style="color: #3366ff;">let</span> result <span style="color: #3366ff;">=</span> sqrt mean2</div>' +
                    '<p><code><code></code></code></p>' +
                    '<div>&nbsp; printfn "<span style="color: #ff0000;">std dev:</span> <span style="color: #3366ff;">%A</span>" result</div>' +
                    '<p><code><code></code></code></p>' +
                    '<div>&nbsp;<span style="color: #339966;"> 0</span></div>' +
                    '<p><code><code></code></code></p>' +
                    '<p>&nbsp;</p>'
            },
            {
                id: 0,
                question: 'Lets break down the code...',
                type: TEXT,
                txt: '<div style="background-color: WhiteSmoke"<p><code><code></code></code></p>' +
                    '<p><code><code></code></code></p>' +
                    '<p><code><code></code></code></p>' +
                    '<div><span style="color: #3366ff;">let</span> data_array <span style="color: #3366ff;">=</span> System.IO.File.ReadAllLines<span style="color: #3366ff;">(</span>"<span style="color: #ff0000;">data.txt</span>"<span style="color: #3366ff;">)</span></div>' +
                    '<p><code><code></code></code></p>' +
                    '<div><span style="color: #3366ff;">let</span> data_list <span style="color: #3366ff;">=</span> Array.toList data_array</div>' +
                    '<p><code><code></code></code></p>' +
                    '<p>&nbsp;</p>'+
                    '<div><span style="color: #3366ff;">let</span> values <span style="color: #3366ff;">=</span> List.map (fun s -&gt; float s) data<span style="color: #3366ff;">_</span>list</div>' +
                    '</div><br> <p>Apply <strong>functions</strong> to transform the data to the answer&hellip;</p>'+
                    '<p><span style="color: #3366ff;"><strong>data_list</strong><strong>:&nbsp;</strong></span>[&ldquo;2&rdquo;;&ldquo;4&rdquo;;&ldquo;4&rdquo;;&ldquo;4&rdquo;;&ldquo;5&rdquo;;&ldquo;5&rdquo;;&ldquo;7&rdquo;;&ldquo;9&rdquo;]</p>' +
                    '<p><span style="color: #3366ff;"><strong>values:&nbsp;</strong></span>[2.0;4.0;4.0;4.0;5.0;5.0;7.0;9.0]</p>'
            },
            {
                id: 5,
                question: 'Fill in the Blanks Question',
                type: FILL_IN_BLANKS,
                txt: 'The answer is "Answer"',
                answers: [
                    {
                        id: 1,
                        answer: 'Answer'
                    }
                ]
            },
            {
                id: 2,
                question: 'Multiple Choice Question',
                type: MULTIPLE_CHOICE,
                txt: 'Question... <br>The answer is "Answer 1"',
                answers: [
                    {
                        id: 1,
                        answer: 'Answer 1',
                        right: true
                    },
                    {
                        id: 2,
                        answer: 'Answer 2'

                    }
                ]
            },
            {
                id: 6,
                question: 'Drag n Drop Question',
                type: DRAG_N_DROP,
                txt: 'Text Section... ',
                answers: [
                    {
                        id: 1,
                        answer: 'Answer 1',
                        right: true
                    },
                    {
                        id: 2,
                        answer: 'Answer 2'

                    }
                ]
            },
            {
                id: 7,
                question: 'Completed!',
                type: END,
                txt: 'Navigate back to the other lessons to learn more!',


            }
        ]

        var step = 0
        var correct = true
        var answer = ""
        var questionTitle = document.getElementById('question-title')
        var questionAnswersContainer = document.getElementById('answers-container')
        var nextButton = document.getElementById('next-button')
        var stepsContainer = document.getElementById('steps-container')
        var backButton = document.getElementById('back-button')


        document.addEventListener("backbutton", onBackKeyDown, false);

        function onBackKeyDown() {
            if (step > 0) {
                step--
                updateQuestion()
                updateSteps()
            }
        }

        backButton.onclick = function () {
            if (step > 0) {
                step--
                updateQuestion()
                updateSteps()
            }
        }


        nextButton.onclick = function () {
            console.log(correct)
            if (items[step].type == FILL_IN_BLANKS && correct) {
                checkAnswer(document.getElementById('input_1').value)
            }
            else {
                nextButton.style.background = '#01bcd5'
                step++
                updateQuestion()
                updateSteps()
            }
        }

        var checkAnswer = function (answer) {
            console.log(document.getElementById('input_1').value)
            if (items[step].answers[0].answer == answer) {
                console.log('answer correct')
                nextButton.style.background = '#8DC443'
                nextButton.innerHTML = 'Next'
                correct = false
            }
            else {
                nextButton.style.background = '#FF0000'
                nextButton.innerHTML = 'Try Again'
            }
        }

        var updateSteps = function () {
            stepsContainer.innerHTML = ''
            var stepsElements = ''
            items.forEach(function (item, i) {
                if (i <= step) {
                    stepsElements += '<span class="active-step"></span>'
                }
                else {
                    stepsElements += '<span class="step"></span>'
                }
            })

            stepsContainer.innerHTML = stepsElements
        }

        var updateQuestion = function () {
            if (items.length <= step) {
                return
            }
            questionTitle.innerHTML = ''
            questionAnswersContainer.innerHTML = ''

            questionTitle.innerHTML = items[step].question

            renderAnswers()
        }

        var renderAnswers = function (type) {
            var answersElements = ''
            var x = document.getElementById("next-button-column");
            if (x.style.display === "none") {
                x.style.display = "block";
            }

            if (items[step].type == MULTIPLE_CHOICE) {
                nextButton.innerHTML = 'Next'
                if (items[step].txt) { answersElements = items[step].txt }
                items[step].answers.forEach(function (a, i) {
                    if (a.chosen) {
                        if (a.right) {
                            answersElements += '<div class="answer-button-right" id="answer-' + step + '-' + i + '"> ' + a.answer + ' </div>'
                        }
                        else {
                            answersElements += '<div class="answer-button-wrong" id="answer-' + step + '-' + i + '"> ' + a.answer + ' </div>'
                        }

                    }
                    else {
                        answersElements += '<div class="answer-button" id="answer-' + step + '-' + i + '"> ' + a.answer + ' </div>'
                    }
                })

                questionAnswersContainer.innerHTML = answersElements

                items[step].answers.forEach(function (a, i) {
                    var stepButton = document.getElementById('answer-' + step + '-' + i)
                    stepButton.onclick = function () {
                        chooseAnswer(i)
                    }
                })
            }
            else if (items[step].type == TEXT) {
                nextButton.innerHTML = 'Next'
                questionAnswersContainer.innerHTML = '<div style="padding:5%" id="answer-' + step + '"><p>' + items[step].txt + '</p></div>'
            }
            else if (items[step].type == FILL_IN_BLANKS) {
                nextButton.innerHTML = 'Check'
                questionAnswersContainer.innerHTML = '<div id="answer-' + step + '"><p>' + items[step].txt + '<input id="input_1" style="border: 0;border-bottom: 2px solid" type="text"></p></div>'
            }
            else if (items[step].type == DRAG_N_DROP) {
                questionAnswersContainer.innerHTML = '<code><div id="div8" ondrop="drop(event)" ondragover="allowDrop(event)">' + items[step].txt + '</div><br>'
                items[step].answers.forEach(function (a, i) {
                    questionAnswersContainer.innerHTML += '<br><div id="div' + i + '" ondrop="drop(event)" ondragover="allowDrop(event)"><label id="answer-' + step + '-' + i + '" draggable="true" ondragstart="drag(event)" width="336" height="69"><code>' + a.answer + '</code></label></div>'
                })
                questionAnswersContainer.innerHTML += '</code>'
                nextButton.innerHTML = 'Check'


            } else if (items[step].type == END) {
                document.getElementById('next-button-column').style.display = "none"
                questionAnswersContainer.innerHTML = '<div style="padding:5%" id="answer-' + step + '"><p>' + items[step].txt + '</p></div>'
            }

        }

        var chooseAnswer = function (answerIndex) {
            if (step >= items.length) {
                return
            }

            items[step].answers.forEach(function (a, i) {
                if (i == answerIndex) {
                    a.chosen = true
                }
                else {
                    a.chosen = false
                }
            })

            renderAnswers()
        }

        updateQuestion()
        updateSteps()

        function allowDrop(ev) {
            ev.preventDefault();
        }

        function drag(ev) {
            ev.dataTransfer.setData("text", ev.target.id);
        }

        function drop(ev) {
            ev.preventDefault();
            var data = ev.dataTransfer.getData("text");
            ev.target.appendChild(document.getElementById(data));
            answer = data
            if (ev.target.id == 'div8') {
                items[step].answers.forEach(function (a, i) {
                    if (a.right) {
                        console.log(a.answer)
                        console.log(('answer-' + step + '-' + i).toString())
                        if (data == ('answer-' + step + '-' + i).toString()) {
                            nextButton.style.background = '#8DC443'
                            nextButton.innerHTML = 'Next'
                        }
                        else {
                            nextButton.style.background = '#d03e2f'
                        }
                    }
                })
            }
            else {
                nextButton.style.background = '#01bcd5'
            }
        }</script>
</body>

</html>